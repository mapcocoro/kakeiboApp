# 💰 家計簿Webアプリ

シンプルで使いやすい家計簿Webアプリです。ブラウザだけで動作し、データはすべてローカル（あなたのPC）に保存されます。

## 🌐 Web版URL（どこからでもアクセス可能）

**→ https://mapcocoro.github.io/kakeiboApp/**

- どのPCからでもアクセス可能
- スマホ・タブレットでも利用可能
- データは各デバイスのブラウザに個別保存
- インターネット接続が必要（初回読み込み時）

## 📁 ファイル構成

```
kakeibo-app/
├── index.html                    # メインHTML
├── style.css                     # スタイルシート
├── app.js                        # アプリケーションロジック
├── .gitignore                    # Git除外設定
├── README.md                     # このファイル
└── update-*.html                 # Topixデータ復元用ファイル
    ├── update-2020-07.html       # 2020年7月データ
    ├── update-multiple-months.html # 2020年8-9月データ
    ├── update-2020-2021.html     # 2020-2021年データ
    └── update-all-remaining.html # 2022-2025年データ
```

## 🚀 使い方

### 1. アプリを開く

**方法1: ダブルクリック**
- `index.html` をダブルクリックしてブラウザで開く

**方法2: ドラッグ&ドロップ**
- `index.html` をブラウザにドラッグ&ドロップ

**方法3: ターミナルから**
```bash
cd ~/kakeibo-app
open index.html
```

### 2. 支出を記録する

#### 通常入力
1. 「入力」タブで「通常入力」を選択
2. 日付、カテゴリ、金額は必須
3. 場所、商品名、メモは任意
4. 「記録」ボタンをクリック

#### 一括入力
1. 「入力」タブで「一括入力」を選択
2. 複数行にまとめて入力可能
3. 「税込」ボタンで自動計算（1.1倍）
4. 「毎月繰り返す」で複数月分を一括登録

### 3. 支出を確認・編集する

1. 「一覧」タブで全支出を確認
2. **検索機能**: 商品名・場所・メモ・カテゴリで検索
3. 期間フィルター: 月指定、カスタム期間で絞り込み
4. カラムヘッダーをクリックでソート
5. 「編集」ボタンで内容を変更
6. 「削除」ボタンで削除

### 4. 推移を確認する

1. 「推移」タブを開く
2. 開始年・終了年を選択
3. カテゴリ別の月次推移を確認
4. Topix（出来事）・予定をセルに入力
5. 複数年にわたる場合は横スクロール可能

### 5. 分析する

1. 「分析」タブを開く
2. 年・月を選択
3. カテゴリ別集計とグラフで可視化
4. 「年指定」で年間推移テーブル表示
5. カラムをクリックでその月でソート

### 6. ふるさと納税を管理する

1. 「ふるさと納税」タブを開く
2. 年度を選択
3. **検索機能**: 品物・申請先・自治体で検索
4. 手動追加: 「新規追加」ボタン
5. 自動同期: 支出入力時に小項目「ふるさと納税」にすると自動登録

## 📊 機能

### ✅ 主要機能

#### データ入力
- 通常入力・一括入力の2モード
- 税込計算（1.1倍）
- 毎月繰り返し登録
- カテゴリ・小項目の階層管理

#### データ管理
- 支出の編集・削除
- 検索機能（一覧・ふるさと納税）
- 期間フィルター
- ソート機能

#### 可視化・分析
- カテゴリ別推移テーブル
- 月次グラフ（積み上げ棒グラフ）
- カテゴリ別円グラフ
- 年間推移テーブル（ヒートマップ）
- 月別メモ・予定管理

#### ふるさと納税管理
- 年度別管理
- 品物受取・納税書チェック
- 自動同期（支出データから）
- 検索機能

#### データ保存
- データエクスポート（CSV形式）
- データインポート（CSV形式）
- レポート保存機能
- 状態の自動保存（タブ・フィルター）

### 🎨 カテゴリ

- 食品
- 日用品
- 外食費
- 衣類
- 家具・家電
- 美容
- 医療費
- 交際費
- レジャー
- ガソリン・ETC
- 光熱費
- 通信費
- 保険
- 車関連【車検・税金・積立】
- 税金
- 経費
- ローン
- その他

各カテゴリには複数の小項目が設定可能です。

## 💾 データの保存

### 保存場所
すべてのデータはブラウザの **localStorage** に保存されます：

- `localStorage.expenses` - 支出データ
- `localStorage.furusatoTaxData` - ふるさと納税データ
- `localStorage.monthlyMemos` - 月別メモ・予定
- `localStorage.yearMemos` - 年別メモ
- `localStorage.appState` - アプリの状態
- `localStorage.savedReports` - 保存済みレポート

### 特徴
- インターネット接続不要
- データは外部に送信されません
- 同じブラウザ・同じPCでのみアクセス可能

### ⚠️ 重要な注意事項

**データが消える操作：**
- ブラウザの「サイトデータをクリア」
- ブラウザの「すべてのデータをクリア」でCookieとサイトデータを削除
- プライベートモード/シークレットモードで使用（閉じた時点で消失）

**データが残る操作：**
- ブラウザの「キャッシュのみ」削除
- ページの再読み込み（Cmd + R / Ctrl + R）

## 👨‍👩‍👧‍👦 複数PC・家族で使う方法

### 📱 各デバイスで個別管理（現在の仕組み）

**Web版URL**: https://mapcocoro.github.io/kakeiboApp/

- **複数PCから同じURLにアクセス可能**
- **データは各デバイスのブラウザに個別保存**（自動同期なし）
- スマホ、タブレット、会社PC、自宅PCなど、どこからでもアクセス可能

### 🔄 データ共有の方法

#### 方法1: CSVで手動同期（推奨）

**PCで入力したデータをスマホに反映する場合：**
1. **PCで**: 「一覧」タブ → 「データエクスポート」でCSVダウンロード
2. CSVファイルをGoogleドライブやメールでスマホに送信
3. **スマホで**: Web版を開く → 「一覧」タブ → 「データインポート」
4. 「置き換え」または「追加」を選択してインポート

**頻度の目安：**
- 週1回、月1回など、定期的に同期
- メインデバイスを決めて、そこから他のデバイスへ配布

#### 方法2: 同じブラウザを使う

- **Chrome同期**: Chromeアカウントでログインすれば、localStorageも同期される可能性あり（非推奨）
- **安定性**: CSVエクスポート/インポートの方が確実

### 👪 家族で共有する場合

#### パターンA: 1つのCSVを共有
1. 誰か1人が「メイン管理者」になる
2. 管理者が定期的にCSVエクスポート
3. 家族全員がそのCSVをインポート
4. 各自が入力したデータは、管理者が集約

#### パターンB: 各自で管理
1. 家族それぞれが自分のデバイスで入力
2. 月末に各自CSVエクスポート
3. 管理者が全員分のCSVをマージ（手動またはExcel）
4. 統合版を家族全員に配布

### ⚠️ 注意事項

- **自動同期なし**: リアルタイム同期は非対応
- **上書き注意**: インポート時に「置き換え」を選ぶと既存データが消えます
- **バックアップ推奨**: 各デバイスで定期的にCSVエクスポート
- **プライベートモード禁止**: シークレットモードではデータが保存されません

## 📤 データのバックアップ

### ✅ 推奨バックアップ方法

#### 1. CSVエクスポート（手動）

**一覧タブから：**
1. 「一覧」タブを開く
2. 「データエクスポート」ボタンをクリック
3. CSVファイル（`家計簿_一覧_YYYY-MM-DD.csv`）がダウンロード
4. 安全な場所（GoogleドライブやDropboxなど）に保存

**推奨頻度：**
- 月に1回以上
- 大量のデータを入力した直後
- ブラウザの設定変更前

#### 2. GitHubバックアップ（自動）

コードとTopixデータはGitHubにバックアップされています：
- リポジトリ: https://github.com/mapcocoro/kakeiboApp.git
- 自動バックアップ対象: コードファイル（HTML/CSS/JS）、Topix復元用ファイル
- 対象外: 支出データ（CSV）、localStorageデータ

### 📥 データの復元

#### CSVからインポート
1. 「一覧」タブを開く
2. 「データインポート」ボタンをクリック
3. 以前エクスポートしたCSVファイルを選択
4. 追加 or 置き換えを選択
5. データが復元されます

#### Topixデータの復元
キャッシュ削除でTopix（出来事）が消えた場合：

1. 該当期間の `update-*.html` をブラウザで開く
   - 2020年7月: `update-2020-07.html`
   - 2020年8-9月: `update-multiple-months.html`
   - 2020年10月〜2021年12月: `update-2020-2021.html`
   - 2022年〜2025年: `update-all-remaining.html`
2. 「更新実行」ボタンをクリック
3. 完了後、アプリ（`index.html`）を開く

## 🔧 カスタマイズ

### カテゴリ・小項目の追加

`index.html` と `app.js` の該当箇所を編集してください。

### 色を変更

`style.css` でカテゴリごとの色を変更できます：

```css
.badge[data-category="食品"] {
    background: #e8f5e9;
    color: #2e7d32;
}
```

## 🐛 トラブルシューティング

### データが表示されない
- 同じブラウザで開いているか確認
- 別のブラウザで開いた場合、データは共有されません
- ブラウザの開発者ツール（F12）→ Consoleでエラーを確認

### データが消えた
1. ブラウザのlocalStorageが削除された可能性
2. 最新のCSVエクスポートファイルからインポート
3. Topixデータは `update-*.html` から復元

### グラフが表示されない
- インターネット接続を確認（Chart.js読み込みに必要）
- ブラウザを最新版にアップデート
- ブラウザのJavaScriptが有効か確認

### ふるさと納税が自動同期されない
- 小項目に「ふるさと納税」という文字列が含まれているか確認
- ブラウザのコンソールでエラーを確認

## 📱 対応ブラウザ

- Chrome（推奨）
- Safari
- Firefox
- Edge

※ Internet Explorerは非対応

## 🔄 バージョン履歴

### v2.1 (2025-11-14)
- ✅ GitHub Pages公開（複数PC・デバイス対応）
- ✅ Web版URL: https://mapcocoro.github.io/kakeiboApp/
- ✅ 複数PC・家族共有の使い方ガイド追加
- ✅ スマホ・タブレット対応

### v2.0 (2025-11-14)
- ✅ 検索機能追加（一覧・ふるさと納税）
- ✅ ふるさと納税自動同期機能
- ✅ ふるさと納税重複チェック修正
- ✅ 推移タブと分析タブのテーブル分離
- ✅ Topix・予定の複数行表示対応
- ✅ グラフツールチップ修正
- ✅ GitHubバックアップ設定

### v1.0 (2025-11-13)
- 初回リリース
- 基本的な家計簿機能
- カテゴリ別分析
- データエクスポート/インポート

## 🔐 プライバシー

- すべてのデータはローカル（お使いのPC）に保存
- インターネット経由での送信なし
- 外部サーバーにデータを保存しません
- Chart.jsのみCDN経由で読み込み

## 📞 サポート

質問や改善要望があれば、GitHubのIssuesまたは直接お知らせください！

---

**作成日**: 2025年11月13日
**最終更新**: 2025年11月14日
**バージョン**: 2.1
**Web版URL**: https://mapcocoro.github.io/kakeiboApp/
**リポジトリ**: https://github.com/mapcocoro/kakeiboApp.git
