<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>å…¨æœŸé–“Topixä¸€æ‹¬æ›´æ–°</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
        }
        .btn {
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            border-radius: 4px;
            border: none;
        }
        .btn-primary {
            background: #1a73e8;
            color: white;
        }
        .btn-primary:hover {
            background: #1557b0;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dadce0;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            max-height: 600px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 11px;
            line-height: 1.4;
        }
        .success {
            color: #0f9d58;
        }
        .month-section {
            color: #1a73e8;
            font-weight: bold;
            margin-top: 8px;
        }
        .summary {
            background: #e8f0fe;
            padding: 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .summary h3 {
            margin-top: 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ“Š å…¨æœŸé–“Topixä¸€æ‹¬æ›´æ–°</h1>
    <div class="summary">
        <h3>æ›´æ–°å¯¾è±¡ï¼š2022å¹´ã€œ2025å¹´ï¼ˆ44ãƒ¶æœˆåˆ†ï¼‰</h3>
        <p>2022-02ã‹ã‚‰2025-12ã¾ã§ã€åˆè¨ˆç´„200ä»¶ä»¥ä¸Šã®Topixãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ‹¬ã§ç™»éŒ²ã—ã¾ã™ã€‚</p>
    </div>

    <button class="btn btn-primary" onclick="updateTopix()">ğŸš€ æ›´æ–°å®Ÿè¡Œ</button>
    <button class="btn" onclick="location.href='index.html'">â† ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹</button>

    <div class="log" id="log"></div>

    <script>
        function log(message, isMonthHeader = false) {
            const logDiv = document.getElementById('log');
            const p = document.createElement('p');
            p.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            p.className = isMonthHeader ? 'month-section' : 'success';
            logDiv.appendChild(p);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateTopix() {
            // æ›´æ–°ã™ã‚‹ãƒ‡ãƒ¼ã‚¿
            const updates = {
                '2022-02': ['ã‚³ãƒ­ãƒŠ'],
                '2022-03': ['ä¹å·æ—…è¡Œ', 'ãƒãƒ¼ã‚¿ãƒ–ãƒ«é›»æº'],
                '2022-04': ['æ±åŒ—æ—…è¡Œ', 'å›ºå®šè³‡ç”£ç¨', 'æ•´éª¨é™¢å›æ•°åˆ¸'],
                '2022-05': ['æ±åŒ—æ—…è¡Œ', 'è‡ªå‹•è»Šç¨', 'è»Šä¿®ç†', 'æ•´ä½“ãªã¤ã'],
                '2022-06': ['æ´—æ¿¯æ©Ÿè³¼å…¥', 'å“²å¤ªã‚ªãƒ¼ãƒ€ãƒ¼ã‚¹ãƒ¼ãƒ„'],
                '2022-07': ['ã‚´ãƒ«ãƒ•ãƒ¬ãƒƒã‚¹ãƒ³', 'ã‚´ãƒ«ãƒ•æ‰“ã¡ã£ã±ãªã—', 'ã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ã‚¹'],
                '2022-08': ['æ¥å®¢ï¼ˆã•ã‚Šï¼‰', 'ã‚´ãƒ«ãƒ•æ‰“ã¡ã£ã±ãªã—', 'ã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ã‚¹'],
                '2022-09': ['ã‚´ãƒ«ãƒ•ã‚¯ãƒ©ãƒ–ã€ã‚¦ã‚§ã‚¢ãªã©', 'ã‚´ãƒ«ãƒ•æ‰“ã¡ã£ã±ãªã—'],
                '2022-10': ['ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¬ãƒƒã‚¹ãƒ³', 'å“²å¤ªä»™å°', 'ã‚´ãƒ«ãƒ•ã‚¦ã‚§ã‚¢ãªã©', 'å“²å¤ªã‚¹ãƒ¼ãƒ„', 'å¹´æœ«ç”¨å¤§é˜ªå¸°çœæ—…è²»'],
                '2022-11': ['è»Šæ¤œ', 'ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¬ãƒƒã‚¹ãƒ³', 'ãµã‚‹ã•ã¨ç´ç¨å¥ˆæœˆ', 'å¹´æœ«ç”¨å¤§é˜ªå¸°çœæ—…è²»'],
                '2022-12': ['è‡ªå‹•è»Šä¿é™ºæ–™', 'å¤§é˜ªå¸°çœ'],
                '2023-01': ['éŸ¿è³¼å…¥', 'å“²å¤ªãƒ©ã‚¹ãƒ™ã‚¬ã‚¹å‡ºå¼µ', 'åŠ æ¹¿å™¨', 'ãƒ‘ã‚¿ãƒ¼ç·´ç¿’ã€TVè³¼å…¥', 'å¥ˆæœˆæ€’ã‚Šé®ã‚æ—…è¡Œï¼ˆçµŒè²»è¨ˆä¸Šï¼‰', 'è»Šä¿®ç†'],
                '2023-02': ['å“²å¤ªãƒ“ã‚¸ãƒã‚¹ãƒ›ãƒ†ãƒ«', 'æœ­å¹Œç¥–çˆ¶è‘¬å„€'],
                '2023-03': ['ã‚ªãƒªãƒ¼ãƒ–ã‚ªã‚¤ãƒ«', 'ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¬ãƒƒã‚¹ãƒ³', 'ãƒ¦ãƒ¼ãƒ©ã‚·ã‚¢Ã—2'],
                '2023-04': ['å›ºå®šè³‡ç”£ç¨', 'BLANDE'],
                '2023-05': ['ã‚·ãƒ«ã‚¯ãƒ‰ã‚½ãƒ¬ã‚¤ãƒ¦', 'è‡ªå‹•è»Šç¨', 'ãªã¤ãã‚µãƒ¼ãƒã‚¯ãƒ¼ãƒ«', 'BLANDE'],
                '2023-06': ['ã‚¿ã‚¤ãƒ¤äº¤æ›', 'ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã‚¯ãƒ«ãƒ¼ã‚ºæ—…è¡Œå…¥é‡‘', 'ã‚«ãƒ¼ãƒŠãƒ“æ›´æ–°'],
                '2023-07': ['æ—…è¡Œæº–å‚™ãƒ»æ—…è¡Œ', 'å¥ˆæœˆãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¬ãƒƒã‚¹ãƒ³', 'ã‚¨ã‚¢ã‚³ãƒ³'],
                '2023-08': ['å“²å¤ªãƒ©ã‚¦ãƒ³ãƒ‰ãƒ¬ãƒƒã‚¹ãƒ³', 'ã‚½ãƒ•ã‚¡ãƒ¼è³¼å…¥', 'å“²å¤ªã‚´ãƒ«ãƒ•', 'æ²³å£æ¹–å¼¾ä¸¸æ—…', 'å†·å‡åº«', 'å¸‚æ°‘ç¨'],
                '2023-09': ['ãµã‚‹ã•ã¨ç´ç¨', 'å¥ˆæœˆå¤§é˜ªï¼†ãƒ¬ãƒ¼ã‚¶ãƒ¼', 'åº­ã®ä¼æ¡æŠœæ ¹', 'å“²å¤ªæœ'],
                '2023-10': ['å“²å¤ªè„±æ¯›', 'å¥ˆæœˆãŠæ–™ç†æ•™å®¤', 'å“²å¤ªæœ', 'å“²å¤ªãƒ‘ãƒ¼ã‚½ãƒŠãƒ«ã‚¸ãƒ ', 'ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è³¼å…¥'],
                '2023-11': ['ãƒ¨ã‚¬å¼•ãè½ã¨ã—é–‹å§‹'],
                '2023-12': ['ãƒ¨ã‚¬é•ç´„é‡‘ãƒ†ãƒƒã‚¿', 'å®®å´æ—…è¡Œ'],
                '2024-01': ['äº¬éƒ½æ—…è¡Œï¼ˆå“²å¤ªå‡ºå¼µï¼‰', 'ãµã‚‹ã•ã¨ç´ç¨', 'é˜²ç½å“è¦‹ç›´ã—'],
                '2024-02': ['GWã‚¯ãƒ«ãƒ¼ã‚ºå…¥é‡‘', 'å“²å¤ªãƒªãƒ¼ã‚¬ãƒ«é´', 'å¥ˆæœˆé…¸æ€§ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆ'],
                '2024-03': ['ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼ãƒ’ãƒ«', 'ã‚´ãƒ«ãƒ•2å›', 'å“²å¤ªã‚µãƒ³ã‚°ãƒ©ã‚¹'],
                '2024-04': ['ãƒˆã‚¹ãƒ©ãƒ–ç®±æ ¹', 'ã‚¯ãƒ«ãƒ¼ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³æ”¯æ‰•ã„', 'å›ºå®šè³‡ç”£ç¨'],
                '2024-05': ['ã‚¯ãƒ«ãƒ¼ã‚º', 'ãƒˆã‚¹ãƒ©ãƒ–æ¹¯æ²¢', 'æ–°æ½Ÿæ—…è¡Œ', 'è‡ªå‹•è»Šä¿é™º'],
                '2024-06': ['é£¯æ‘ç‰›', 'æº¶é€£èŒ', 'å¥ˆæœˆé£›è¡Œæ©Ÿï¼ˆï¼˜æœˆå¤§é˜ªï¼‰', 'å“²å¤ªã‚¿ãƒ–ãƒ¬ãƒƒãƒˆ'],
                '2024-07': ['ã‚¢ãƒƒãƒ†ã‚£ãƒ¼ãƒœ3ãƒ¶æœˆåˆ†', 'å¥ˆæœˆç¾å®¹é™¢ã€ãƒ¬ãƒ¼ã‚¶ãƒ¼ã€ã‚¨ã‚¹ãƒ†', 'å¥ˆæœˆæ–°å¹¹ç·šï¼ˆæ±äº¬â†’å¤§é˜ªï¼‰', 'æ°´é“ä»£ï¼ˆåº­å‡ºã—ã£ã±ãªã—ï¼‰'],
                '2024-09': ['åœ°éœ‡ä¿é™º', 'ã‚ªãƒ¼ãƒ–ãƒ³ã€ãƒ‰ãƒ©ã‚¤ãƒ¤ãƒ¼è³¼å…¥', 'ãƒ™ã‚¿ãƒ¼ãƒ›ãƒ¼ãƒ '],
                '2024-10': ['å“²å¤ªçµŒè²»ãƒ‘ã‚½ã‚³ãƒ³'],
                '2024-11': ['è‡ªå‹•è»Šä¿é™º', 'è»Šæ¤œ', 'å°æ¹Šæ—…è¡Œ'],
                '2024-12': ['GWå¤§é˜ªæ—…è²»ï¼ˆé£›è¡Œæ©Ÿã€ãƒ›ãƒ†ãƒ«ï¼‰', 'æ­£æœˆé‡‘æ²¢æ—…è¡Œï¼ˆæ–°å¹¹ç·šï¼‹ãƒ›ãƒ†ãƒ«ï¼‰', 'ãµã‚‹ã•ã¨ç´ç¨', 'ï¼ˆãƒãƒˆãƒ©ãƒƒã‚»è³¼å…¥ï¼‰'],
                '2025-01': ['å¥ˆæœˆãƒ•ã‚©ãƒˆãƒŠ', 'é‡‘æ²¢æ—…è¡Œ'],
                '2025-02': ['ãƒ†ã‚¹ãƒ©è³¼å…¥!!', 'ä¼šç¤¾ã‚’è¨­ç«‹'],
                '2025-03': ['ä¼‘æš‡æ‘é¤¨å±±æ—…è¡Œ', 'è»Šã‚³ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ä¿é™ºè¿½åŠ ', 'å“²å¤ªãŒèƒƒç‚'],
                '2025-04': ['å›ºå®šè³‡ç”£ç¨(2/4æœŸåˆ†)', 'å“²å¤ªãŒèƒƒç‚'],
                '2025-05': ['å¤§é˜ªå‡ºå¼µï¼ˆEXPOï¼‰'],
                '2025-06': ['MacBook Air'],
                '2025-07': ['ãƒ™ãƒƒãƒ‰ï¼ˆãƒãƒƒãƒˆãƒ¬ã‚¹ï¼‰', 'æ–°æ½Ÿå‡ºå¼µ', 'å¥ˆæœˆã‚¨ã‚¹ãƒ†'],
                '2025-08': ['å¥ˆæœˆã‚¦ãƒ«ã‚»ãƒ©', 'å¥ˆæœˆç¾å®¹é™¢', 'å¥ˆæœˆå¤§é˜ªå‡ºå¼µ', 'å“²å¤ªãƒ¬ãƒ¼ã‚¶ãƒ¼ã»ãã‚', 'å¥ˆæœˆã‚¨ã‚¹ãƒ†ï¼ˆX2ï¼‰', 'ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒ„ãƒ«ãƒ¤'],
                '2025-09': ['å“²å¤ªåŒ—æµ·é“æ—…è¡Œ', 'ãµã‚‹ã•ã¨ç´ç¨'],
                '2025-10': ['ç¨é‡‘ï¼ˆå¹´é‡‘ã€å›½ä¿ã€ä½æ°‘ç¨ï¼‰'],
                '2025-11': ['å¥ˆæœˆãƒ¬ãƒ¼ã‚¶ãƒ¼ï¼ˆãƒã‚¤ãƒ•ï¼†ã‚¹ãƒ†ãƒ©ï¼‰', 'ãƒ€ã‚¤ã‚½ãƒ³ã‚¨ã‚¢ãƒ©ãƒƒãƒ—', 'CHANELååˆºå…¥ã‚Œï¼†ãƒãƒƒã‚¯ãƒ¬ã‚¹ï¼ˆÂ¥224,400ï¼‰', 'å“²å¤ªäºˆå‚™æ ¡ï¼ˆ404,000ï¼‰'],
                '2025-12': ['å›ºå®šè³‡ç”£ç¨', 'è‡ªå‹•è»Šä¿é™º']
            };

            log('========== æ›´æ–°é–‹å§‹ ==========', true);
            log(`å¯¾è±¡: ${Object.keys(updates).length}ãƒ¶æœˆåˆ†ã®ãƒ‡ãƒ¼ã‚¿`);

            // æ—¢å­˜ã®ãƒ¡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const existingMemos = JSON.parse(localStorage.getItem('monthlyMemos') || '{}');

            let totalAdded = 0;
            let totalSkipped = 0;
            let monthsUpdated = 0;

            // å„æœˆã‚’æ›´æ–°
            for (const [yearMonth, newEvents] of Object.entries(updates)) {
                // ãã®æœˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
                const memo = existingMemos[yearMonth] || { events: '', plans: '', notes: '' };

                // æ—¢å­˜ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’é…åˆ—ã«å¤‰æ›
                const currentEvents = memo.events ? memo.events.split('\n').filter(e => e.trim()) : [];

                let addedThisMonth = 0;

                // é‡è¤‡ãƒã‚§ãƒƒã‚¯ã—ãªãŒã‚‰è¿½åŠ 
                newEvents.forEach(event => {
                    if (!currentEvents.includes(event)) {
                        currentEvents.push(event);
                        addedThisMonth++;
                        totalAdded++;
                    } else {
                        totalSkipped++;
                    }
                });

                // ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
                existingMemos[yearMonth] = {
                    events: currentEvents.join('\n'),
                    plans: memo.plans || '',
                    notes: memo.notes || ''
                };

                if (addedThisMonth > 0) {
                    log(`ã€${yearMonth}ã€‘${addedThisMonth}ä»¶è¿½åŠ  â†’ åˆè¨ˆ${currentEvents.length}ä»¶`);
                    monthsUpdated++;
                }
            }

            // localStorageã«ä¿å­˜
            localStorage.setItem('monthlyMemos', JSON.stringify(existingMemos));

            log('\n========== å®Œäº† ==========', true);
            log(`âœ“ ${monthsUpdated}ãƒ¶æœˆã‚’æ›´æ–°`);
            log(`âœ“ åˆè¨ˆ ${totalAdded}ä»¶ã®Topixã‚’è¿½åŠ `);
            log(`âœ“ ${totalSkipped}ä»¶ã¯æ—¢ã«å­˜åœ¨ã—ã¦ã„ãŸã®ã§ã‚¹ã‚­ãƒƒãƒ—`);
            log('=============================', true);

            setTimeout(() => {
                if (confirm('âœ… æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\nã‚¢ãƒ—ãƒªã‚’é–‹ã„ã¦ç¢ºèªã—ã¾ã™ã‹ï¼Ÿ')) {
                    location.href = 'index.html';
                }
            }, 1500);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«çµ±è¨ˆã‚’è¡¨ç¤º
        window.onload = function() {
            const existingMemos = JSON.parse(localStorage.getItem('monthlyMemos') || '{}');

            log('ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã‚’ç¢ºèªä¸­...');

            let totalExisting = 0;
            let monthsWithData = 0;

            for (const [month, memo] of Object.entries(existingMemos)) {
                if (memo.events) {
                    const count = memo.events.split('\n').filter(e => e.trim()).length;
                    totalExisting += count;
                    monthsWithData++;
                }
            }

            log(`ç¾åœ¨ã®çŠ¶æ…‹: ${monthsWithData}ãƒ¶æœˆã«åˆè¨ˆ${totalExisting}ä»¶ã®Topix`);
            log('\næº–å‚™å®Œäº†ã€‚ã€Œæ›´æ–°å®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚', true);
        };
    </script>
</body>
</html>
